FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.version"="0.1.0"
LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IGtleWNsb2FrLWFwYgpkZXNjcmlwdGlvbjogSWRlbnRpdHkgTWFu\
YWdlbWVudCAtIElkZW50aXR5IGFuZCBBY2Nlc3MgTWFuYWdlbWVudApiaW5kYWJsZTogVHJ1ZQph\
c3luYzogcmVxdWlyZWQKdGFnczogCiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVu\
dC1lbmFibGVkCm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiAxMTExLklkZW50aXR5IE1hbmFnZW1l\
bnQKICBpbWFnZVVybDogImh0dHBzOi8vcGJzLnR3aW1nLmNvbS9wcm9maWxlX2ltYWdlcy83MDIx\
MTk4MjE5NzkzNDQ4OTcvb0FDMDVjRUJfNDAweDQwMC5wbmciCiAgZG9jdW1lbnRhdGlvblVybDog\
Imh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmcvZXh0ZXJuYWwvYXBiL2tleWNsb2FrLmh0bWwiCiAg\
cHJvdmlkZXJEaXNwbGF5TmFtZTogIlJlZCBIYXQsIEluYy4iCiAgZGVwZW5kZW5jaWVzOgogICAg\
LSAiZG9ja2VyLmlvL2pib3NzL2tleWNsb2FrLW9wZW5zaGlmdDozLjQuMy5GaW5hbCIKICAgIC0g\
ImRvY2tlci5pby9jZW50b3MvcG9zdGdyZXNxbC05Ni1jZW50b3M3OjkuNiIKICBzZGstZG9jcy1h\
bmRyb2lkOiAiaHR0cHM6Ly9kb2NzLmFlcm9nZWFyLm9yZy9leHRlcm5hbC9hcGIvaWRtL2FuZHJv\
aWQuaHRtbCIKICBzZGstZG9jcy1jb3Jkb3ZhOiAiaHR0cHM6Ly9kb2NzLmFlcm9nZWFyLm9yZy9l\
eHRlcm5hbC9hcGIvaWRtL2NvcmRvdmEuaHRtbCIKICBzZGstZG9jcy1pb3M6ICJodHRwczovL2Rv\
Y3MuYWVyb2dlYXIub3JnL2V4dGVybmFsL2FwYi9pZG0vaW9zLmh0bWwiCiAgc2RrLWRvY3MteGFt\
YXJpbjogImh0dHBzOi8vZG9jcy5hZXJvZ2Vhci5vcmcvZXh0ZXJuYWwvYXBiL2lkbS94YW1hcmlu\
Lmh0bWwiCiAgc2VydmljZU5hbWU6IGtleWNsb2FrCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAog\
ICAgZGVzY3JpcHRpb246IERlcGxveSBrZXljbG9hawogICAgZnJlZTogVHJ1ZQogICAgbWV0YWRh\
dGE6CiAgICAgIG1vYmlsZWNsaWVudF9iaW5kX3BhcmFtZXRlcnNfZGF0YToKICAgICAgICAtICd7\
Im5hbWUiOiAiQ0xJRU5UX0lEIiwgInZhbHVlIjogIm1ldGFkYXRhLm5hbWUiLCAidHlwZSI6ICJw\
YXRoIn0nCiAgICAgICAgLSAneyJuYW1lIjogIkNMSUVOVF9UWVBFIiwgInZhbHVlIjogInB1Ymxp\
YyIsICJ0eXBlIjogImRlZmF1bHQifScKICAgICAgc2VydmljZWluc3RhbmNlX2JpbmRfcGFyYW1l\
dGVyc19kYXRhOgogICAgICAgIC0gJ3sibmFtZSI6ICJDTElFTlRfSUQiLCAidmFsdWUiOiAibWV0\
YWRhdGEubmFtZSIsICJ0eXBlIjogInBhdGgifScKICAgICAgICAtICd7Im5hbWUiOiAiQ0xJRU5U\
X1RZUEUiLCAidmFsdWUiOiAiYmVhcmVyIiwgInR5cGUiOiAiZGVmYXVsdCJ9JwogICAgcGFyYW1l\
dGVyczogCiAgICAtIG5hbWU6IFRBRwogICAgICByZXF1aXJlZDogRmFsc2UKICAgICAgc3R5cGU6\
IHN0cmluZwogICAgICB0aXRsZTogS2V5Y2xvYWsgbmFtZSB0YWcgLSBrZXljbG9hay1UQUcKICAg\
IC0gbmFtZTogQURNSU5fVVNFUk5BTUUKICAgICAgcmVxdWlyZWQ6IFRydWUKICAgICAgZGVmYXVs\
dDogYWRtaW4KICAgICAgdHlwZTogc3RyaW5nCiAgICAgIHRpdGxlOiBLZXljbG9hayBhZG1pbiB1\
c2VybmFtZQogICAgLSBuYW1lOiBBRE1JTl9QQVNTV09SRAogICAgICByZXF1aXJlZDogVHJ1ZQog\
ICAgICBkZWZhdWx0OiBhZG1pbgogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IEtleWNs\
b2FrIGFkbWluIHBhc3N3b3JkCiAgICAtIG5hbWU6IENVU1RPTV9SRUFMTV9OQU1FCiAgICAgIHJl\
cXVpcmVkOiBGYWxzZQogICAgICB0eXBlOiBzdHJpbmcKICAgICAgdGl0bGU6IE5hbWUgb2YgdGhl\
IEtleWNsb2FrIHJlYWxtIChkZWZhdWx0cyB0byBjdXJyZW50IG5hbWVzcGFjZSkKICAgIC0gbmFt\
ZTogVVNFX1NIQVJFRF9TRVJWSUNFCiAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICB0eXBlOiBi\
b29sCiAgICAgIHRpdGxlOiBDb25uZWN0IHRvIGFuIGV4aXN0aW5nIHNoYXJlZCBzZXJ2aWNlCiAg\
ICAtIG5hbWU6IFNIQVJFRF9IT1NUCiAgICAgIHJlcXVpcmVkOiBGYWxzZQogICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgdGl0bGU6IFVSTCBvZiB0aGUgc2hhcmVkIHNlcnZpY2UKICAgIGJpbmRfcGFy\
YW1ldGVyczoKICAgIC0gbmFtZTogQ0xJRU5UX0lECiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAg\
IHRpdGxlOiBNb2JpbGUgY2xpZW50IElEL1NlcnZpY2UgSUQKICAgICAgdHlwZTogc3RyaW5nCiAg\
ICAtIG5hbWU6IENMSUVOVF9UWVBFCiAgICAgIHJlcXVpcmVkOiBUcnVlCiAgICAgIHRpdGxlOiBL\
ZXljbG9hayBjbGllbnQgdHlwZQogICAgICB0eXBlOiBlbnVtCiAgICAgIGVudW06IFsnYmVhcmVy\
JywgJ3B1YmxpYyddCiAgICAgIGRlZmF1bHQ6IHB1YmxpYwo="


COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
COPY vars /opt/ansible/vars
RUN yum install epel-release -y && yum install jq -y
RUN ansible-galaxy install -r /opt/apb/actions/requirements.yml -p /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb